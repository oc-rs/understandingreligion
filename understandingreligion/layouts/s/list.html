<!DOCTYPE html>
<html class="has-navbar-fixed-top">

    {{ partial "head.html" . }}

    <body>

        {{ partial "navbar.html" . }}

        <section style="background-color: #032539" class="hero is-small">
            <div class="hero-body">
                <div class="container has-text-white has-text-centered">
                    <h1 class="title has-text-white is-size-1">
                    {{ .Title }}
                    </h1>
                </div>
            </div>
        </section>
        
        <section style="background-color: #1c768f" class="section has-text-white">

            <div class="columns">
        
                <div style="border-left: 10px solid #FA991C" class="column is-8 is-offset-2">

                    {{ if (isset .Params "abstract") }}
                    <h2 class="subtitle has-text-white">{{ .Params.abstract}}</h2>
                    {{ end }}
        
                    <input id="searchbox" class="input is-size-4" type="text" placeholder="Search {{ .Title }}..." onkeyup="search()">
                </div>
            </div>
        </section>

        <section style="background-color: #FBF3F2" class="section">
            
            <div class="container">


                <div class="columns is-multiline">
                        {{ range .Pages.ByTitle }}
                        <div class="item column is-one-quarter">
                          <article class="tile is-child box">

                            {{ if (isset .Params "categories") }}
                            {{ range .Params.categories }}
                            <p style="background-color: #032539; color: #FFF; position: relative; top: -30px; left: -10px; padding: 5px; margin: 0px; display: inline-block"><a style="border-bottom: none;" href="/categories/{{ . | urlize }}">{{ . }}</a></p>
                            {{ end }}
                            {{ else }}
                            {{ end }}    
                        
                            {{ if (eq .Params.source true) }}
                            {{ range .Params.sourcetypes }}
                            <p style="background-color: #FA991C; color: #000000; position: relative; top: -30px; left: -10px; padding: 5px; margin: 0px; display: inline-block"><a href="/sourcetypes/{{ . | urlize }}">{{ . }}</a></p>
                            {{ end }}
                            {{ end }}

                                <p class="title item-title">{{ .Title }}</p>
                                
                                {{ if (eq .Params.source true) }}
                                <p class="subtitle"><span class="item-author">{{ .Params.sourceauthor }}</span> {{ with .Params.originalyear }}(<span class="item-year">{{ . }}</span>){{end}}</p>
                                {{ end }}
                                
                                <p class="item-abstract">{{ .Params.abstract | truncate 100 }}</p>
                                
                                <p style="margin-top: 5px"><a href="{{.Permalink}}">Start reading...</a></p>

                                {{ if (isset .Params "tags") }}
                                <hr>
                                <div class="item-taglist">
                                    {{ range .Params.tags }}
                                    <span><a class="tag" href="/tags/{{ . | urlize }}">{{ . }}</a></span>&nbsp;
                                    {{ end }}
                                </div>
                                {{ else }}
                                {{ end }}

                                <p class="searchstring" style="display: none">

                                    <span class="ss_categories">
                                    {{ with .Params.categories }}
                                    {{ . }}
                                    {{ end }}    
                                    </span>
                                    
                                    <span class="ss_sourcetypes">
                                    {{ with .Params.sourcetypes }}
                                    {{ . }}
                                    {{ end }}
                                    </span>
                                    
                                    <span class="ss_title">
                                    {{ .Title }}
                                    </span>
                                    
                                    <span class="ss_sourceauthor">
                                    {{ with .Params.sourceauthor }}
                                    {{ . }}
                                    {{ end }}
                                    </span>
                                    
                                    <span class="ss_year">
                                    {{ with .Params.originalyear }}
                                    {{ . }}
                                    {{ end }}
                                    </span>
                                    
                                    <span class="ss_abstract">
                                    {{ with .Params.abstract }}
                                    {{ . }}
                                    {{ end }}
                                    </span>
                                    
                                    <span class="ss_tags">
                                    {{ with .Params.tags }}
                                    {{ . }}
                                    {{ end }}
                                    </span>
                                    
                                </p>

                          </article>
                        </div>
                        {{ end }}
                      </div>

            </div>
            
        </section>

        <div id="search-modal" class="modal">
            <div class="modal-background"></div>
            <div class="container is-fluid" style="position: absolute; top: 25px">
                <div class="columns is-mobile">
                    <div class="column is-10">
                        <input onkeyup="titleSearch()" id="title-mobile-input" placeholder="Search by title" style="margin-bottom: 10px;" type="text" class="input">
                        {{ range .Pages.ByTitle }}
                        <p class="title-result-item" style="display: none; padding: 5px; border-bottom: 1px solid grey">
                            <a class="title-result-link" style="color: white;" href="{{ .Permalink }}">
                               {{ .Title }}
                            </a>
                        </p>
                        {{ end }}
                    </div>
                    <div class="column is-2">
                        <button onclick="closeModal()" class="modal-close is-large"></button>
                    </div>
                </div>
            </div>
        </div>

        <div id="search-author-modal" class="modal">
                <div class="modal-background"></div>
                <div class="container is-fluid" style="position: absolute; top: 25px">
                    <div class="columns is-mobile">
                        <div class="column is-10">
                            <input onkeyup="authorSearch()" placeholder="Search by author" id="author-mobile-input" style="margin-bottom: 10px;" type="text" class="input">
                            {{ range .Pages.ByTitle }}
                            <p class="author-result-item" style="display: none; padding: 5px; border-bottom: 1px solid grey">
                                <a class="author-result-link" style="color: white;" href="{{ .Permalink }}">
                                   {{ .Params.sourceauthor }} ({{ .Title }})
                                </a>
                            </p>
                            {{ end }}
                        </div>
                        <div class="column is-2">
                            <button onclick="closeModal()" class="modal-close is-large"></button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="search-year-modal" class="modal">
                    <div class="modal-background"></div>
                    <div class="container is-fluid" style="position: absolute; top: 25px">
                        <div class="columns is-mobile">
                            <div class="column is-10">
                                <input onkeyup="yearSearch()" placeholder="Search by year" id="year-mobile-input" style="margin-bottom: 10px;" type="number" class="input">
                                {{ range .Pages.ByTitle }}
                                <p class="year-result-item" style="display: none; padding: 5px; border-bottom: 1px solid grey">
                                    <a class="year-result-link" style="color: white;" href="{{ .Permalink }}">
                                       {{ .Params.originalyear }} ({{ .Title }})
                                    </a>
                                </p>
                                {{ end }}
                            </div>
                            <div class="column is-2">
                                <button onclick="closeModal()" class="modal-close is-large"></button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="search-tag-modal" class="modal">
                        <div class="modal-background"></div>
                        <div class="container is-fluid" style="position: absolute; top: 25px">
                            <div class="columns is-mobile">
                                <div class="column is-10">
                                    <input onkeyup="tagSearch()" placeholder="Search by tags" id="tag-mobile-input" style="margin-bottom: 10px;" type="text" class="input">
                                    {{ range .Pages.ByTitle }}
                                    <p class="tag-result-item" style="display: none; padding: 5px; border-bottom: 1px solid grey">
                                        <a class="tag-result-link" style="color: white;" href="{{ .Permalink }}">{{ .Title }} ( {{ range .Params.tags }}{{ . }} {{ end }})</a>
                                    </p>
                                    {{ end }}
                                </div>
                                <div class="column is-2">
                                    <button onclick="closeModal()" class="modal-close is-large"></button>
                                </div>
                            </div>
                        </div>
                    </div>

        {{ partial "footer.html" . }}
    </body>
</html>
